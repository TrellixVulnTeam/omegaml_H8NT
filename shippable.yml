build-environment: Ubuntu 12.04
language: python
services:
 - mysql
before_script:
    - bash ./install-conda.sh
# init for mongodb v3.2.0
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927
    - echo "deb http://repo.mongodb.org/apt/ubuntu precise/mongodb-org/3.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.2.list
    - sudo apt-get -y update
    - shippable_retry sudo apt-get install -y mongodb-org=3.2.7 mongodb-org-server=3.2.7 mongodb-org-shell=3.2.7 mongodb-org-mongos=3.2.7 mongodb-org-tools=3.2.7
    - sudo su -c "/usr/bin/mongod -f /etc/mongod.conf --smallfiles > /dev/null 2>&1 &"
# end for mongodb
script:
  - PATH=$HOME/.omegaml/miniconda/bin:$PATH nosetests -v
    --with-xunit --xunit-file=shippable/testresults/nosetests.xml 
    --with-xcoverage --cover-package=omegaml
    --cover-tests  --xcoverage-file=shippable/codecoverage/coverage.xml

